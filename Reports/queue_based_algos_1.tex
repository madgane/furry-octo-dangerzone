
User selection which has the objective of reducing the expected queue of each user select users with higher queue backlogs. The selection strategy based on queue and the channel condition is discussed extensively in \cite{neely2012stability}. The queue based selection based on Lyapunov drift reduction along with power reduction is also discussed. The performance of those schemes are well suited for single user MIMO (SU-MIMO) where the entire spatial dimension is allotted for a single user.

In case of MU-MIMO, the users sharing spatial dimension will share the power and moreover interfere with each other unless precoder decouples the transmitted data. In order to decouple the transmitted data, the channel of the users in \me{\mc{S}} should be uncorrelated spatially. Once precoders are designed, power allocation for each users is performed based on queues and the channel condition in order to minimize the expected queue length for each users.

Let \me{\mbf{Q}_i(n)} represents the backlog packets at \me{n^\mrm{th}} instant and \me{\mbf{b}_i(n)} represents the transmission bits at \me{n^\mrm{th}} instant for \me{i^\mrm{th}} user. The Lyapunov formulation is based on minimizing the queue variation at \me{n} and \me{n + 1} instant. The queue update at \me{n+1} is given by
\begin{equation}
\mbf{Q}(n+1) = \min \setcont{\mbf{Q}(n) - \mbf{b}(n),0} + \lambda(n)
\end{equation}
and the Lyapunov drift minimization is given by
\begin{eqnarray}
L(\mbf{Q}(n + 1)) - L(\mbf{Q}(n)) &=& \mbf{Q}(n + 1)^2 - \mbf{Q}(n)^2 \\
&=& \matscont{\min \setcont{\mbf{Q}(n) - \mbf{b}(n),0} + \lambda(n)}^2 - \mbf{Q}(n)^2
\label{qba1-e0}
\end{eqnarray}
where \eqref{qba1-e0} is optimized to minimize the Lyapunov drift as discussed in \cite{neely2010stochastic}.

Upon reducing the formulation in \eqref{qba1-e0} with the minimizing objective, the drift minimizing user scheduling for the set \me{\mc{S}} is given by
\begin{eqnarray}
&\displaystyle \max_{\mc{S} \inm \mc{U}} \, \sum_{i \inm \mc{S}}\mbf{Q}_i(n) \, \mbf{b}_i(n) \\
&\displaystyle \mrm{subject \: to,} \quad \card{\mc{S}} \leq N_\mrm{T}.
\label{qba1-e1}
\end{eqnarray}
The above problem is difficult to solve due to the constraint \eqref{qba1-e1} which casts it as a combinatorial search problem. The suboptimal solution is proposed by considering user selection in an incremental manner as seen in Sect. \ref{mtbus}. Since \me{\mbf{b}(n)} is given by \me{ \textstyle \log \left \lbrace 1 + \frac{\gnorm{\mvecxy{h}{i}}^2}{N_\mrm{0}} \right \rbrace } at \me{n^\mrm{th}} instant, the optimization function for the user \me{i} is given by
\begin{eqnarray}
&\displaystyle \max_{\fall i \inm \mc{U}} \, \mbf{Q}_i \, \log \left \lbrace 1 + \frac{P_\mrm{i} \; \gnorm{\mvecxy{h}{i}}^2}{N_\mrm{0}} \right \rbrace \\
&\displaystyle \max_{\fall i \inm \mc{U}} \, \mbf{Q}_i \, \left [ \; 2 \, \log \left \lbrace P_\mrm{i} \; \gnorm{\mvecxy{h}{i}} \right \rbrace - \log \left \lbrace N_\mrm{0} \right \rbrace \; \right ]
\label{qba1-e2}
\end{eqnarray}
where \eqref{qba1-e2} is based on high-SNR approximation. Since \me{N_\mrm{0}} is constant and can be dropped, the approximated objective is given by \me{\max_i \mbf{Q}_i \: \mvecxy{h}{i}} where \me{\log \{x \} \approx x}. The sharing of total transmission power among \me{\mc{S}} is not known during user selection, the optimization objective includes only the channel norm with path loss in the final formulation.

The queue weighted user selection is performed as briefed in \cite{sus2006zfbf,sun2009eigenmode} with queue weighted channel vectors. This scheduling provides queue stability and reduces the expected queue size for each user \cite{neely2012stability}. If precoder is based on ZF, power allocation needs to be performed with the objective of maximizing the sum rate with queue as weights to achieve the above discussed optimization objective.

